setwd("C:/Users/topalw/Desktop/PhD/Analyses/2.recombination/recombination/0.smc++")
len <- read.table('ss.counts')
head(len)
names(len) <- c('snps','ss')
ns <- read.table('reference_Ns.bed')
head(ns)
names(ns) <- c('ss','start','end')
ns$len <- ns$end - ns$start
nss <- aggregate(ns$len, by=list(ns$ss), FUN=sum)
head(nss)
head(ns)
len$ns <- nss$x[match(len$ss,nss$Group.1)]
len
# plot
plot(len$snps~len$ns)
# plot
plot(len$na)
# plot
plot(len$ns)
len
# plot
plot(len$snps~len$ss)
# plot
barplot(len$snps~len$ss)
?barplot
# plot
barplot(len$snps,names=len$ss)
# plot
barplot(len$snps[order(len$snps,decreasing = T)],names=len$ss)
# plot
barplot(len$snps[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
)
# plot
barplot(len$snps[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
cex.names=.5)
# plot
barplot(len$snps[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
cex.names=.5,las=2)
# plot
par(mfrow=c(1,2))
barplot(len$snps[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
cex.names=.5,las=2)
# plot
par(mfrow=c(2,1))
barplot(len$snps[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
cex.names=.5,las=2)
barplot(len$ns[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
xaxt='n')
# plot
par(fig=c(0,1,.3,1),mar=c(0.5,.5,.5,.5))
barplot(len$snps[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
cex.names=.5,las=2)
# plot
par(fig=c(0,1,.5,1),mar=c(0.5,.5,.5,.5))
barplot(len$snps[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
cex.names=.5,las=2)
par(fig=c(0,1,0,.5),mar=c(0.5,.5,.5,.5))
barplot(len$ns[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
xaxt='n')
par(fig=c(0,1,0,.5),mar=c(0.5,.5,.5,.5),new=T)
barplot(len$ns[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
xaxt='n')
# plot
par(fig=c(0,1,.5,1),mar=c(0.5,.5,.5,.5))
barplot(len$snps[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
cex.names=.5,las=2)
par(fig=c(0,1,0,.5),mar=c(0.5,.5,.5,.5),new=T)
barplot(len$ns[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
xaxt='n')
barplot(len$ns[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
xaxt='n',fill='n')
?barplot
barplot(len$ns[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
xaxt='n',border='black')
barplot(len$ns[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
xaxt='n',border='black',col='n')
barplot(len$ns[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
xaxt='n',border='black',col=white)
barplot(len$ns[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
xaxt='n',border='black',col='white')
# plot
par(fig=c(0,1,.5,1),mar=c(0.5,.5,.5,.5))
barplot(len$snps[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
cex.names=.5,las=2)
par(fig=c(0,1,0.5,0),mar=c(0.5,.5,.5,.5),new=T)
barplot(len$ns[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
xaxt='n',border='black',col='white')
par(fig=c(0,1,.5,0),mar=c(0.5,.5,.5,.5),new=T)
barplot(len$ns[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
xaxt='n',border='black',col='white')
# plot
par(fig=c(0,1,.5,1),mar=c(0.5,.5,.5,.5))
barplot(len$snps[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
cex.names=.5,las=2)
par(fig=c(0,1,.5,0),mar=c(0.5,.5,.5,.5),new=T)
par(fig=c(0,1,0,.5),mar=c(0.5,.5,.5,.5),new=T)
barplot(len$ns[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
xaxt='n',border='black',col='white')
# plot
par(fig=c(0,1,0,.5),mar=c(0.5,.5,.5,.5))
barplot(len$ns[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
xaxt='n',border='black',col='white',,new=T)
par(fig=c(0,1,.5,1),mar=c(0.5,.5,.5,.5))
barplot(len$snps[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
cex.names=.5,las=2)
barplot(len$ns[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
xaxt='n',border='black',col='white')
# plot
par(fig=c(0,1,0,.5),mar=c(0.5,.5,.5,.5))
barplot(len$ns[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
xaxt='n',border='black',col='white')
par(fig=c(0,1,.5,1),mar=c(0.5,.5,.5,.5))
barplot(len$snps[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
cex.names=.5,las=2)
# plot
par(fig=c(0,1,0,.5),mar=c(0.5,.5,.5,.5))
barplot(len$ns[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
xaxt='n',border='black',col='white')
par(fig=c(0,1,.5,1),mar=c(0.5,.5,.5,.5),new=T)
barplot(len$snps[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
cex.names=.5,las=2)
#par(fig=c(0,1,.5,1),mar=c(0.5,.5,.5,.5),new=T)
barplot(len$snps[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
cex.names=.5,las=2,stacked=T)
#par(fig=c(0,1,.5,1),mar=c(0.5,.5,.5,.5),new=T)
barplot(len$snps[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
cex.names=.5,las=2,add=T)
barplot(len$ns[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
xaxt='n',border='black',col='white',add=T)
ns
len$ns
# plot
par(mfrow=c(1,1))
barplot(len$ns[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
xaxt='n',border='black',col='white',add=T)
#par(fig=c(0,1,.5,1),mar=c(0.5,.5,.5,.5),new=T)
barplot(len$snps[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
cex.names=.5,las=2,add=T)
#par(fig=c(0,1,.5,1),mar=c(0.5,.5,.5,.5),new=T)
barplot(len$snps[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
cex.names=.5,las=2,add=T)
# plot
par(mfrow=c(1,1))
#par(fig=c(0,1,.5,1),mar=c(0.5,.5,.5,.5),new=T)
barplot(len$snps[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
cex.names=.5,las=2,add=T)
#par(fig=c(0,1,.5,1),mar=c(0.5,.5,.5,.5),new=T)
barplot(len$snps[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
cex.names=.5,las=2)
barplot(len$ns[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
xaxt='n',border='black',col='white',add=T)
dev.off()
#par(fig=c(0,1,.5,1),mar=c(0.5,.5,.5,.5),new=T)
barplot(len$snps[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
cex.names=.5,las=2)
barplot(len$ns[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
xaxt='n',border='black',col='white',add=T)
barplot(len$ns[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
axes=F,col='white',add=T)
#par(fig=c(0,1,.5,1),mar=c(0.5,.5,.5,.5),new=T)
barplot(len$snps[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
cex.names=.5,las=2)
barplot(len$ns[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
axes=F,col='white',add=T)
barplot(len$ns[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
axes=F,col='white',add=T,xaxt='n')
#par(fig=c(0,1,.5,1),mar=c(0.5,.5,.5,.5),new=T)
barplot(len$snps[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
cex.names=.5,las=2)
barplot(len$ns[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
axes=F,col='white',add=T,xaxt='n')
len$ns
len$ns/len$snps
barplot(len$ns[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
cex.names=.5,las=2)
#par(fig=c(0,1,.5,1),mar=c(0.5,.5,.5,.5),new=T)
barplot(len$snps[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
cex.names=.5,las=2,add=T)
#par(fig=c(0,1,.5,1),mar=c(0.5,.5,.5,.5),new=T)
barplot(len$snps[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
cex.names=.5,las=2,add=T,log='y')
#par(fig=c(0,1,.5,1),mar=c(0.5,.5,.5,.5),new=T)
barplot(len$snps[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
cex.names=.5,las=2,add=T,log='y')
#par(fig=c(0,1,.5,1),mar=c(0.5,.5,.5,.5),new=T)
barplot(len$snps[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
cex.names=.5,las=2,add=T,logy=T)
#par(fig=c(0,1,.5,1),mar=c(0.5,.5,.5,.5),new=T)
barplot(len$snps[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
cex.names=.5,las=2,add=T,ylog=T)
barplot(len$ns[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
cex.names=.5,las=2)
barplot(len$ns[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
cex.names=.5,las=2)
#par(fig=c(0,1,.5,1),mar=c(0.5,.5,.5,.5),new=T)
barplot(len$snps[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
cex.names=.5,las=2)
par(fig=c(0,1,.4,1),mar=c(0.5,.5,.5,.5),new=T)
barplot(len$snps[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
cex.names=.5,las=2)
par(fig=c(0,1,.4,1),mar=c(0.5,.5,.5,.5))
barplot(len$snps[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
cex.names=.5,las=2)
par(fig=c(0,1,0,.3),mar=c(0.5,.5,1,1),new=T)
barplot(len$ns[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
xaxt='n')
pdf('snps_Ns.pdf',height=8,width=12)
par(fig=c(0,1,.4,1),mar=c(0.5,.5,.5,.5))
barplot(len$snps[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
cex.names=.5,las=2)
par(fig=c(0,1,0,.3),mar=c(0.5,.5,1,1),new=T)
barplot(len$ns[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
xaxt='n')
dev.off()
pdf('snps_Ns.pdf',height=8,width=12)
pdf('snps_Ns.pdf',height=8,width=12)
par(fig=c(0,1,.4,1),mar=c(0.5,.5,.5,.5))
barplot(len$snps[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
cex.names=.5,las=2)
par(fig=c(0,1,0,.3),mar=c(0.5,.5,.5,.5),new=T)
barplot(len$ns[order(len$snps,decreasing = T)],
names=len$ss[order(len$snps,decreasing = T)],
xaxt='n')
dev.off()
hist(len$snps)
dev.off()
hist(len$snps)
barplot(len$snps)
plot(density(len$snps))
plot(density(len$snps),xlim=c(0,8e5))
len[order(len$snps,decreasing = T),]
len[order(len$snps,decreasing = T),c(1,2)]
len2 <- len[len$snps > 100,]
len2
write.table(len2$ss,'more_than_100_snps.table',quote=F,row.names = F,col.names=F)
len[len$snps < 100,]
